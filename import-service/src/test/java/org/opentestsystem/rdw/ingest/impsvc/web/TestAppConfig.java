package org.opentestsystem.rdw.ingest.impsvc.web;

import org.springframework.cloud.autoconfigure.RefreshAutoConfiguration;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import org.springframework.web.servlet.config.annotation.EnableWebMvc;

import java.util.Collections;
import org.opentestsystem.rdw.ingest.impsvc.repository.DataSourceConfiguration;
import org.opentestsystem.rdw.multitenant.Tenant;
import org.opentestsystem.rdw.multitenant.TenantProperties;

/**
 * This configures an application context that has just enough to test controllers.
 */
@Configuration
@ComponentScan({"org.opentestsystem.rdw.ingest.impsvc.web", "org.opentestsystem.rdw.ingest.impsvc.auth"})
@Import({
        DataSourceConfiguration.class,
        RefreshAutoConfiguration.class,
})
@EnableWebMvc
class TestAppConfig {

    static final String AuthHeader = "Authorization";
    static final String ClientToken = "sbac;;";
    static final String AuthHeaderForClient = "Bearer " + ClientToken;
    static final String UserTokenWithAuthority = "sbac;dwtest@example.com;|CA|ASMTDATALOAD|STATE|SBAC||||CA|CA|||||||||";
    static final String AuthHeaderWithAuthority = "Bearer " + UserTokenWithAuthority;

    @Bean
    public TenantProperties tenantProperties() {
        final Tenant tenant = new Tenant("CA", "CA", "California");
        final TenantProperties tenantProperties = new TenantProperties();
        tenantProperties.setTenants(Collections.singletonMap(tenant.getKey(), tenant));
        return tenantProperties;
    }
}
