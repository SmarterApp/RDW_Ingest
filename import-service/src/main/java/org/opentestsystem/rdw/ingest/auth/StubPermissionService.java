package org.opentestsystem.rdw.ingest.auth;

import com.google.common.collect.ImmutableList;
import com.google.common.collect.ImmutableMap;
import org.opentestsystem.rdw.security.service.PermissionService;

import java.util.Collection;
import java.util.Map;

/**
 * A stub implementation of {@link PermissionService} that just returns roles/permissions needed
 * to make testing easier. Currently returns ASMTDATALOAD -> {} and GROUP_ADMIN -> {Write, Read}.
 */
class StubPermissionService implements PermissionService {

    private final Map<String, Collection<String>> permissionsByRole = ImmutableMap.of(
            Authorities.DataLoadRole, ImmutableList.of(),
            Authorities.GroupAdminRole, ImmutableList.of(Authorities.GroupWritePermission, Authorities.GroupReadPermission));

    @Override
    public Map<String, Collection<String>> getPermissionsByRole() {
        return permissionsByRole;
    }
}
