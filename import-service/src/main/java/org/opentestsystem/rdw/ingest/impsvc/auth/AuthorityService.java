package org.opentestsystem.rdw.ingest.impsvc.auth;

import org.springframework.security.core.GrantedAuthority;

import java.util.Set;
import org.opentestsystem.rdw.security.Permission;
import org.opentestsystem.rdw.utils.TenancyChain;

/**
 * This service knows all about roles, permissions and spring security authorities.
 */
public interface AuthorityService {

    /**
     * Extract authorities from roles granted by a tenancy chain.<br/>
     * Only roles and permissions associated with this component are converted,
     * other roles/permissions in the grants are quietly ignored.
     *
     * @param tenancyChain tenancy chain with grants
     * @return set of authorities granted by the tenancy chain
     */
    Set<GrantedAuthority> getAuthorities(TenancyChain tenancyChain);

    /**
     * Extract permissions from roles granted by a tenancy chain.<br/>
     * Only roles and permissions associated with this component are converted,
     * other roles/permissions in the grants are quietly ignored.
     *
     * @param tenancyChain tenancy chain with grants
     * @return set of permissions granted by the tenancy chain.
     */
    Set<Permission> getPermissions(TenancyChain tenancyChain);
}
