package org.opentestsystem.rdw.ingest.repository;

import org.opentestsystem.rdw.common.model.ImportContent;
import org.opentestsystem.rdw.common.model.ImportStatus;
import org.opentestsystem.rdw.ingest.common.model.RdwImport;
import org.opentestsystem.rdw.ingest.common.model.RdwImportQuery;

import java.util.List;

/**
 * A repository that manages {@link RdwImport}s
 */
public interface RdwImportRepository {

    /**
     * Create a new import record. This ignores any id on the import object; the returned
     * object will have a newly assigned id and new created/updated values.
     *
     * @param rdwImport import object to save
     * @return newly saved import object
     */
    RdwImport create(RdwImport rdwImport);

    /**
     * Update an existing import record. The id on the import object must be set. The
     * returned object will have a new updated value.
     *
     * @param rdwImport import object to save
     * @return updated import object
     */
    RdwImport update(RdwImport rdwImport);

    /**
     * @param id id of import record
     * @return import record, null if id not found
     */
    RdwImport findOne(long id);

    /**
     * @param content content to match
     * @param digest digest to match
     * @return import if there is a match, null if no match
     */
    RdwImport findOneByContentAndDigest(ImportContent content, String digest);

    boolean exists(long id);

    long count();

    void delete(long id);

    /**
     * Query for import records.
     *
     * @param query query parameters
     * @return list of matching records, may be empty, won't be null
     */
    List<RdwImport> findBy(RdwImportQuery query);

    /**
     * Return the list of import statuses defined in the system.
     * This list should not change except perhaps during software upgrades.
     * This method is provided mostly as a diagnostic hook.
     *
     * @return list of import statuses
     */
    List<ImportStatus> findAllStatuses();
}
