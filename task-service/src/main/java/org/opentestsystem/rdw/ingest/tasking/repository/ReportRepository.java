package org.opentestsystem.rdw.ingest.tasking.repository;

import org.opentestsystem.rdw.ingest.common.model.RdwImportQuery;
import org.opentestsystem.rdw.ingest.tasking.model.ReconciliationReport;

import java.io.IOException;
import java.io.OutputStream;

/**
 * Source of reports.
 */
public interface ReportRepository {

    /**
     * Write a reconciliation report to the output for exam imports matching the query parameters.
     * query.content and query.status are ignored: all EXAMs of any status are queried. But note
     * that only imports that have associated exams will be included in the report so, effectively,
     * only PROCESSED EXAM imports will be queried.
     *
     * @param query import query
     * @throws RuntimeException exception if any problems
     */
    void writeReconciliationReport(RdwImportQuery query, OutputStream os);

    /**
     * Return count of exam import records matching the query parameters.
     * query.content and query.status are ignored: all EXAMs of any status are counted.
     *
     * @param query import query
     * @return number of import records matching the query
     */
    long countExamImports(RdwImportQuery query);

    /**
     * @return return true if repository is available to get reports
     */
    boolean isAvailable();
}