package org.opentestsystem.rdw.ingest.status;

import org.junit.Test;

import static org.assertj.core.api.Assertions.assertThat;

public class SystemStatusTest {

    @Test
    public void itHasDefaults() {
        final SystemStatus status = SystemStatus.builder().build();
        assertThat(status.getStatusRating()).isEqualTo(4);
        assertThat(status.getStatusText()).isEqualTo("Ideal");
        assertThat(status.getDateTime()).isNotNull();
    }

    @Test
    public void itShouldPreserveBuilderValues() {
        final ConfigurationStatus configurationStatus = ConfigurationStatus.builder().build();
        final DatabaseStatus databaseStatus = DatabaseStatus.builder().build();
        final LocalSystemStatus localSystemStatus = LocalSystemStatus.builder().build();
        final ProvidersStatus providersStatus = ProvidersStatus.builder().build();

        final SystemStatus status = SystemStatus.builder()
                .rating(BaseStatus.Rating.Degraded)
                .level(5)
                .unit("test")
                .configuration(configurationStatus)
                .database(databaseStatus)
                .localSystem(localSystemStatus)
                .providers(providersStatus)
                .build();
        assertThat(status.getStatusRating()).isEqualTo(1);
        assertThat(status.getStatusText()).isEqualTo("Degraded");
        assertThat(status.getLevel()).isEqualTo(5);
        assertThat(status.getUnit()).isEqualTo("test");
        assertThat(status.getConfiguration()).isEqualTo(configurationStatus);
        assertThat(status.getDatabase()).isEqualTo(databaseStatus);
        assertThat(status.getLocalSystem()).isEqualTo(localSystemStatus);
        assertThat(status.getProviders()).isEqualTo(providersStatus);
    }
}