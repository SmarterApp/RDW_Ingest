package org.opentestsystem.rdw.ingest.migrate.reporting;

import org.junit.Before;
import org.springframework.batch.core.JobExecution;
import org.springframework.batch.core.StepExecution;
import org.springframework.batch.item.ExecutionContext;
import org.springframework.batch.test.MetaDataInstanceFactory;

import java.time.Instant;

public abstract class SpringBatchStepIT extends SpringBatchIT {

    protected final Instant firstAt = Instant.parse("2017-07-18T19:05:34.965Z");
    protected final Instant lastAt = Instant.parse("2017-07-18T20:14:34.000Z");
    protected static final String StagingTablePrefix = "reporting_test.staging_";

    private StepExecution stepExecution;

    @Before
    public void createStepExecution() {
        stepExecution = MetaDataInstanceFactory.createStepExecution();
    }

    protected JobExecution launchStep(String stepName) {
        return getJobLauncherTestUtils().launchStep(stepName, getStepExecutionContext());
    }

    protected ExecutionContext getStepExecutionContext() {
        return stepExecution.getExecutionContext();
    }
}
