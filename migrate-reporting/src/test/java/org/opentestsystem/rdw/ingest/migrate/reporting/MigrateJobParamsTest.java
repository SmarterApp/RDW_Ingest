package org.opentestsystem.rdw.ingest.migrate.reporting;

import org.junit.Test;
import org.springframework.batch.core.JobParameter;

import java.time.Instant;

import static org.assertj.core.api.Assertions.assertThat;

public class MigrateJobParamsTest {

    @Test
    public void itShouldSetIdentifyingJobParamAndPreserveCtorValues() {
        final Instant firstAt = Instant.parse("2017-05-18T19:06:34.966Z");
        final Instant lastAt = Instant.parse("2017-05-20T19:06:34.966Z");
        final MigrateJobParameters jobParameters = new MigrateJobParameters(firstAt, lastAt, true);

        final JobParameter jobIdParam = jobParameters.getParameters().get(MigrateJobParameters.JobIdentifier);
        assertThat(jobIdParam.isIdentifying()).isTrue();
        assertThat(jobIdParam.getValue()).isNotNull();

        assertThat(jobParameters.getFirstAt()).isEqualTo(firstAt);
        assertThat(jobParameters.getLastAt()).isEqualTo(lastAt);
        assertThat(jobParameters.getMigrateCodes()).isTrue();
    }
}