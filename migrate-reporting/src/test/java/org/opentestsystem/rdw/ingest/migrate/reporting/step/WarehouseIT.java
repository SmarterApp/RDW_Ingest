package org.opentestsystem.rdw.ingest.migrate.reporting.step;

import org.junit.Test;
import org.opentestsystem.rdw.ingest.migrate.reporting.SpringBatchIT;
import org.springframework.batch.core.ExitStatus;
import org.springframework.batch.core.JobExecution;

import static org.assertj.core.api.Assertions.assertThat;
import static org.opentestsystem.rdw.ingest.migrate.reporting.MigrateReportingConfiguration.stepWarehouseName;

public class WarehouseIT extends SpringBatchIT {

    @Test
    public void testStep() throws Exception {
        final JobExecution jobExecution = getJobLauncherTestUtils().launchStep(stepWarehouseName);

        assertThat(jobExecution.getExitStatus().getExitCode()).isEqualTo(ExitStatus.COMPLETED.getExitCode());
    }
}
