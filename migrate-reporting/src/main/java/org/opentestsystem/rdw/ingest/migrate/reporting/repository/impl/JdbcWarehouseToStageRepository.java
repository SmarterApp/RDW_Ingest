package org.opentestsystem.rdw.ingest.migrate.reporting.repository.impl;

import org.opentestsystem.rdw.ingest.migrate.reporting.repository.WarehouseToStageRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate;
import org.springframework.stereotype.Repository;

import java.util.List;
import java.util.Map;

@Repository
public class JdbcWarehouseToStageRepository implements WarehouseToStageRepository {

    private final NamedParameterJdbcTemplate warehouseJdbcTemplate;
    private final NamedParameterJdbcTemplate reportingJdbcTemplate;

    @Autowired
    public JdbcWarehouseToStageRepository(final NamedParameterJdbcTemplate warehouseJdbcTemplate,
                                          final NamedParameterJdbcTemplate reportingJdbcTemplate) {

        this.warehouseJdbcTemplate = warehouseJdbcTemplate;
        this.reportingJdbcTemplate = reportingJdbcTemplate;

    }

    @Value("${sql.warehouseToStage.findWarehouseSubjects}")
    private String findWarehouseSubjects;

    @Value("${sql.warehouseToStage.findReportingSubjects}")
    private String findReportingSubjects;

    @Value("${sql.warehouseToStage.findWarehouseAsmtTypes}")
    private String findWarehouseAsmtType;

    @Value("${sql.warehouseToStage.findReportingAsmtTypes}")
    private String findReportingAsmtType;

    @Value("${sql.warehouseToStage.findWarehouseSubjectClaimScores}")
    private String findWarehouseSubjectClaimScore;

    @Value("${sql.warehouseToStage.findReportingSubjectClaimScores}")
    private String findReportingSubjectClaimScore;

    @Override
    public List<Map<String, Object>> findWarehouseSubjects() {
        return warehouseJdbcTemplate.getJdbcOperations()
                .queryForList(findWarehouseSubjects);
    }

    @Override
    public List<Map<String, Object>> findReportingSubjects() {
        return reportingJdbcTemplate.getJdbcOperations()
                .queryForList(findReportingSubjects);
    }

    @Override
    public List<Map<String, Object>> findWarehouseAsmtTypes() {
        return warehouseJdbcTemplate.getJdbcOperations()
                .queryForList(findWarehouseAsmtType);
    }

    @Override
    public List<Map<String, Object>> findReportingAsmtTypes() {
        return reportingJdbcTemplate.getJdbcOperations()
                .queryForList(findReportingAsmtType);
    }

    @Override
    public List<Map<String, Object>> findWarehouseSubjectClaimScores() {
        return warehouseJdbcTemplate.getJdbcOperations()
                .queryForList(findWarehouseSubjectClaimScore);
    }

    @Override
    public List<Map<String, Object>> findReportingSubjectClaimScores() {
        return reportingJdbcTemplate.getJdbcOperations()
                .queryForList(findReportingSubjectClaimScore);
    }
}
