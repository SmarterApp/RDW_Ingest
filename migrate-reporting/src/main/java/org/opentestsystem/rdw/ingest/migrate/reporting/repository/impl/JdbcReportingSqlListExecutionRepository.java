package org.opentestsystem.rdw.ingest.migrate.reporting.repository.impl;

import org.opentestsystem.rdw.ingest.migrate.reporting.repository.SqlListExecutionRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

/**
 * Jdbc implementation of {@link SqlListExecutionRepository} on the reporting datamart
 */
@Repository
class JdbcReportingSqlListExecutionRepository implements SqlListExecutionRepository {

    @Autowired
    @Qualifier("reportingJdbcTemplate")
    private NamedParameterJdbcTemplate jdbcTemplate;

    @Transactional
    @Override
    public void execute(final Iterable<String> sqls) {

        for (final String sql : sqls) {
            jdbcTemplate
                    .getJdbcOperations()
                    .execute(sql);
        }
    }
}