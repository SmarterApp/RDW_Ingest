package org.opentestsystem.rdw.ingest.migrate.reporting.step;

import org.opentestsystem.rdw.ingest.migrate.reporting.ExecutionParams;
import org.opentestsystem.rdw.ingest.migrate.reporting.Migrate;
import org.springframework.batch.core.scope.context.ChunkContext;
import org.springframework.batch.core.step.tasklet.Tasklet;
import org.springframework.batch.item.ExecutionContext;

/**
 * A helper with common tasklet methods
 */
public abstract class StepTasklet implements Tasklet {

    /**
     * Retrieves {@link Migrate} from the job's {@link ExecutionContext}
     *
     * @param chunkContext the {@link ChunkContext}
     * @return the {@link Migrate}
     */
    protected Migrate getJobBatch(final ChunkContext chunkContext) {
        final Migrate migrate = (Migrate) chunkContext.getStepContext().getStepExecution().getJobExecution().getExecutionContext().get(ExecutionParams.migrate);
        if (migrate == null) throw new IllegalArgumentException("missing migrate");
        return migrate;
    }
}
