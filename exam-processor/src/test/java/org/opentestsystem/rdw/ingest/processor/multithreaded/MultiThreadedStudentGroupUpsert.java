package org.opentestsystem.rdw.ingest.processor.multithreaded;

import org.opentestsystem.rdw.ingest.processor.model.StudentGroup;
import org.opentestsystem.rdw.ingest.processor.repository.StudentGroupRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Profile;
import org.springframework.stereotype.Component;

import java.time.Instant;

@Profile("mtTest")
@Component
public class MultiThreadedStudentGroupUpsert extends MultiThreadedTest {
    @Autowired
    private StudentGroupRepository repository;

    private StudentGroup group;

    @Override
    protected void before() {
        final int schoolId = createSchool();

        group = StudentGroup.builder()
                .name("test")
                .schoolId(schoolId)
                .schoolYear(2017)
                .active(true)
                .creator("test")
                .created(Instant.now())
                .build();
    }

    @Override
    protected void work() {
        repository.upsert(group, 1);
    }
}
