package org.opentestsystem.rdw.ingest.processor.model;

import javax.validation.constraints.NotNull;
import java.util.Objects;

/**
 * This is a representation of metadata for an item from the Tabulator processing of an assessment package
 */
public class Item {
    private final String naturalId;
    private final int claimId;
    private final int targetId;
    private final float difficulty;
    private final int dokId;
    private Integer mathPractice;
    private Boolean allowCalculator;
    private Integer maxScore;
    private int assessmentId;
    private String assessmentNaturalId;

    private Item(@NotNull final String naturalId, @NotNull final int claimId, @NotNull final int targetId,
                 @NotNull final float difficulty, @NotNull final int dokId) {
        this.naturalId = naturalId;
        this.claimId = claimId;
        this.targetId = targetId;
        this.difficulty = difficulty;
        this.dokId = dokId;
        this.mathPractice = mathPractice;
        this.allowCalculator = allowCalculator;
    }

    public String getNaturalId() {
        return naturalId;
    }

    public int getClaimCodeId() {
        return claimId;
    }

    public int getTargetId() {
        return targetId;
    }

    public float getDifficulty() {
        return difficulty;
    }

    public int getDokId() {
        return dokId;
    }

    public Integer getMathPractice() {
        return mathPractice;
    }

    public boolean isAllowCalculator() {
        return allowCalculator;
    }

    public static Builder builder() {
        return new Builder();
    }

    /**
     * This instance is equal to all instances of {@code Assessment} that have equal attribute values.
     * @return {@code true} if {@code this} is equal to {@code another} instance
     */
    @Override
    public boolean equals(Object another) {
        if (this == another) return true;
        return another instanceof Item
                && equalTo((Item) another);
    }

    private boolean equalTo(Item another) {
        return Objects.equals(naturalId, another.naturalId) &&
            claimId == another.claimId &&
            targetId == another.targetId &&
            difficulty == another.difficulty &&
            dokId == another.dokId &&
            mathPractice == another.mathPractice &&
            Objects.equals(allowCalculator, another.allowCalculator);
    }

    /**
     * Computes a hash code from attributes.
     * @return hashCode value
     */
    @Override
    public int hashCode() {
        return Objects.hash(naturalId, claimId, targetId, difficulty, dokId, mathPractice, allowCalculator); }

    public static class Builder {
        private String naturalId;
        private int claimId;
        private int targetId;
        private float difficulty;
        private int dokId;
        private Integer mathPractice;
        private Boolean allowCalculator;

        public Item build() {
            final Item item = new Item(naturalId, claimId, targetId, difficulty, dokId);
            mathPractice = item.mathPractice;
            allowCalculator = item.allowCalculator;
            return item;
        }

        public Builder naturalId(String naturalId){
            this.naturalId = naturalId;
            return this;
        }
        public Builder claimId(int claimId){
            this.claimId = claimId;
            return this;
        }
        public Builder targetId(int targetId){
            this.targetId = targetId;
            return this;
        }
        public Builder difficulty(float difficulty){
            this.difficulty = difficulty;
            return this;
        }
        public Builder dok(int dok){
            this.dokId = dokId;
            return this;
        }
        public Builder mathPractice(Integer mathPractice){
            this.mathPractice = mathPractice;
            return this;
        }
        public Builder allowCalculator(Boolean allowCalculator){
            this.allowCalculator = allowCalculator;
            return this;
        }
    }
}