package org.opentestsystem.rdw.ingest.processor.repository;

import org.opentestsystem.rdw.ingest.processor.model.Percentile;

import java.time.LocalDate;
import java.util.Collection;
import java.util.List;

/**
 * PercentileRepository - Interface for bulk inserting an percentile tables.
 */
public interface PercentileRepository {
    /**
     * Method to create new {@link Percentile}s
     *
     * @param percentiles collection of {@link Percentile}s
     * @param importId    id of the import that is creating the {@link Percentile}s
     */
    void create(Collection<Percentile> percentiles, long importId);

    /**
     * Finds an id of a {@link Percentile} table by unique key.  Each {@link Percentile} has a repository generated unique id
     * and a composite natural identifier of assessmentId, startDate and endDate.
     *
     * @param assessmentId the repository assessment id
     * @param startDate    the start date of the date range
     * @param endDate      the end date of the date range
     * @return the id, null if code not found
     */
    Integer findIdByKey(Integer assessmentId, LocalDate startDate, LocalDate endDate);

    /**
     * Finds ids of {@link Percentile} tables for the given assessmentId and date range.
     *
     * @param assessmentId the repository assessment id
     * @param startDate    the start date of the date range
     * @param endDate      the end date of the date range
     * @return the id, null if code not found
     */
    List<Integer> findIdsByDateOverlap(Integer assessmentId, LocalDate startDate, LocalDate endDate);

}