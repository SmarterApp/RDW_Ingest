package org.opentestsystem.rdw.ingest.processor.repository;

import org.opentestsystem.rdw.ingest.processor.model.Assessment;
import org.opentestsystem.rdw.ingest.processor.model.Item;

import java.util.Collection;

/**
 * AssessmentPackageRepository - Interface for bulk inserting an assessment "package", which is a
 * collection of Assessments and corresponding Items
 */
public interface AssessmentPackageRepository {
    /**
     * Method to create new {@link Assessment}s
     *
     * @param assessments collection of {@link Assessment}s
     * @param importId    id of the import that is creating the {@link Assessment}s
     */
    void create(Collection<Assessment> assessments, long importId);

    /**
     * Method to update {@link Assessment}s.
     * In this case each {@link Assessment} represents modifications, and it assumes the caller had applied the following logic:
     * </ul>
     * <li> each {@link Assessment} has its db ids initialized.</li>
     * <li> delta logic on the items has been applied, only newly addedded or updated items are expected</li>
     * <li>if an {@link Item} is updated, its db id is initialized </li>
     * </ul>
     * Note that items are not deleted.
     *
     * @param assessments collection of {@link Assessment}s
     * @param importId    id of the import that is updating the {@link Assessment}s
     */
    void update(Collection<Assessment> assessments, long importId);

    /**
     * Finds an {@link Assessment} by its natural id.
     *
     * @param naturalId the natural id
     * @return the found {@link Assessment}; null if not found
     */
    Assessment findOneByNaturalId(String naturalId);
}

