package org.opentestsystem.rdw.ingest.processor.repository;

import org.opentestsystem.rdw.ingest.processor.model.WarehouseTarget;

import java.util.Collection;

/**
 * Repository for dealing with the target translation table
 */
public interface TargetRepository {

    /**
     * Finds an id of the target by its code and claim
     *
     * @param naturalId the naturalId of the target
     * @param claimId   The parent claim id
     * @return the id if it exists, null if it doesn't
     */
    Integer findIdByNaturalIdAndClaimId(String naturalId, int claimId);

    /**
     * Find all targets for the given subject.
     *
     * @param subjectCode   A subject code
     * @return All targets for the given subject
     */
    Collection<WarehouseTarget> findBySubject(String subjectCode);

    /**
     * Create new targets for the given subject
     *
     * @param subjectCode   A subject code
     * @param targets       The targets to create
     */
    void create(String subjectCode, Collection<WarehouseTarget> targets);

    /**
     * Delete the given targets by id
     *
     * @param targetIds The target ids to remove
     */
    void delete(Collection<Integer> targetIds);

    /**
     * Test if any of the given targets are referenced by any assessment items.
     *
     * @param targetIds The target ids to test
     * @return The first target id that is reference by an assessment item
     */
    Integer isReferenced(Collection<Integer> targetIds);

}
