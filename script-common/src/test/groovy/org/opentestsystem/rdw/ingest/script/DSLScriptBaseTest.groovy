package org.opentestsystem.rdw.ingest.script

import org.junit.Before
import org.junit.Test
import org.mockito.Mock

import static org.hamcrest.CoreMatchers.is
import static org.junit.Assert.assertThat

class DSLScriptBaseTest {
    private DSLScriptBase script

    @Mock
    private InputStream inputStream

    @Before
    void setUp() {
        script = new DSLScriptBase() {
            @Override
            Object run() {
                return null
            }
        }
    }

    @Test
    void itShouldBindProperties() {
        Map<String,Object> properties = new HashMap<>()
        properties.put("key", "value")
        properties.put("key2", "value2")
        script.bindProperties(properties)

        assertThat(script.getProperty("key"), is("value"))
        assertThat(script.getProperty("key2"), is("value2"))
    }

    @Test
    void itShouldBindInputStream() {
        script.bindInput(inputStream)
        assertThat(script.getProperty("input"), is(inputStream))
    }
}