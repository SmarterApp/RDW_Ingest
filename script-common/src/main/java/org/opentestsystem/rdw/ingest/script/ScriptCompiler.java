package org.opentestsystem.rdw.ingest.script;

import groovy.lang.GroovyClassLoader;
import org.codehaus.groovy.control.CompilationFailedException;

/**
 * Compiles a script into a class with the given class loader.
 */
public class ScriptCompiler {
    private final GroovyClassLoader classLoader;

    public ScriptCompiler(GroovyClassLoader classLoader) {
        this.classLoader = classLoader;
    }

    public Class<? extends PipelineScript> compile(final String scriptCode) throws CompilationFailedException {
        Class<?> clazz = classLoader.parseClass(scriptCode);
        return clazz.asSubclass(PipelineScript.class);
    }
}
