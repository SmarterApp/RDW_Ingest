package org.opentestsystem.rdw.ingest.migrate.olap;

import org.opentestsystem.rdw.migrate.common.MigrateLifecycle;
import org.springframework.stereotype.Component;

import javax.annotation.PostConstruct;

/**
 * Because the run() method on MigrateOlapReportingJobRunner is annotated @Async it cannot have a
 * {@literal @}PostConstruct annotation. Instead, this bean forces it to run on startup.
 *
 * @see MigrateOlapReportingJobRunner
 */
@Component
public class RunOnStartup {
    private final MigrateLifecycle jobRunner;

    public RunOnStartup(final MigrateLifecycle jobRunner) {
        this.jobRunner = jobRunner;
    }

    @PostConstruct
    public void initialize() {
        jobRunner.run();
    }
}
